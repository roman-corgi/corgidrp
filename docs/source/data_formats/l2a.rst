.. _l2a-label:

L2a Data Product
========================================


FITS HDU Structure
------------------


+-------+------------------+----------+----------------------+
| Index | Name             | Datatype | Array Size           |
+=======+==================+==========+======================+
| 0     | Primary          | None     | 0                    |
+-------+------------------+----------+----------------------+
| 1     | Image            | float64  | (1024, 1024)         |
+-------+------------------+----------+----------------------+
| 2     | ERR              | float64  | (1, 1024, 1024)      |
+-------+------------------+----------+----------------------+
| 3     | DQ               | int64    | (1024, 1024)         |
+-------+------------------+----------+----------------------+
| 4     | BIAS             | float32  | (1024,)              |
+-------+------------------+----------+----------------------+


Header
------

Primary Header (HDU 0)
^^^^^^^^^^^^^^^^^^^^^^


+------------+------------+--------------------------------+----------------------------------------------------+
| Keyword    | Datatype   | Example Value                  | Description                                        |
+============+============+================================+====================================================+
| SIMPLE     | bool       | True                           | conforms to FITS standard                          |
+------------+------------+--------------------------------+----------------------------------------------------+
| BITPIX     | int        | 8                              | array data type                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| NAXIS      | int        | 0                              | number of array dimensions                         |
+------------+------------+--------------------------------+----------------------------------------------------+
| EXTEND     | bool       | True                           |                                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| OBSID      | int        | 0                              | Observation ID                                     |
+------------+------------+--------------------------------+----------------------------------------------------+
| BUILD      | int        | 22                             | CDMS pipeline build                                |
+------------+------------+--------------------------------+----------------------------------------------------+
| OBSTYPE    | str        | SCI                            | Observation Template                               |
+------------+------------+--------------------------------+----------------------------------------------------+
| OBSNUM     | int        | 0                              |                                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| OBSNAME    | str        | SCI                            |                                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| PHTCNT     | bool       | False                          |                                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| VISTYPE    | str        | TDEMO                          |                                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| ORIGIN     | str        | DRP                            |                                                    |
+------------+------------+--------------------------------+----------------------------------------------------+


Image Header (HDU 1)
^^^^^^^^^^^^^^^^^^^^


+------------+------------+--------------------------------+----------------------------------------------------+
| Keyword    | Datatype   | Example Value                  | Description                                        |
+============+============+================================+====================================================+
| XTENSION   | str        | IMAGE                          | Image extension                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| BITPIX     | int        | -64                            | array data type                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| NAXIS      | int        | 2                              | number of array dimensions                         |
+------------+------------+--------------------------------+----------------------------------------------------+
| NAXIS1     | int        | 1024                           |                                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| NAXIS2     | int        | 1024                           |                                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| PCOUNT     | int        | 0                              | number of parameters                               |
+------------+------------+--------------------------------+----------------------------------------------------+
| GCOUNT     | int        | 1                              | number of groups                                   |
+------------+------------+--------------------------------+----------------------------------------------------+
| ARRTYPE    | str        | SCI                            |                                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| SCTSRT     | str        | 2024-04-03T10:54:02.382        | Start TAI                                          |
+------------+------------+--------------------------------+----------------------------------------------------+
| SCTEND     | str        | 2024-04-03T10:54:05.357        | Start TAI                                          |
+------------+------------+--------------------------------+----------------------------------------------------+
| STATUS     | int        | 0                              |                                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| HVCBIAS    | int        | 0                              | HV Clock bias                                      |
+------------+------------+--------------------------------+----------------------------------------------------+
| OPMODE     | str        | RESERVED                       | EXCAM readout operational mode                     |
+------------+------------+--------------------------------+----------------------------------------------------+
| EXPTIME    | float      | 30.0                           | Exposing stage duration (seconds)                  |
+------------+------------+--------------------------------+----------------------------------------------------+
| CMDGAIN    | float      | 1000.0                         | Commanded gain                                     |
+------------+------------+--------------------------------+----------------------------------------------------+
| CYCLES     | int        | 121802434017                   | EXCAM clock cycles since boot                      |
+------------+------------+--------------------------------+----------------------------------------------------+
| LASTEXP    | int        | 1200000000                     | clock cycles spent in last exposure stage of re    |
+------------+------------+--------------------------------+----------------------------------------------------+
| BLNKTIME   | float      | 0.001560125                    | commanded blanking (seconds)                       |
+------------+------------+--------------------------------+----------------------------------------------------+
| BLNKCYC    | int        | 62405                          | commanded blanking (cycles)                        |
+------------+------------+--------------------------------+----------------------------------------------------+
| EXPCYC     | int        | 1200000000                     | Exposing stage duration (cycles)                   |
+------------+------------+--------------------------------+----------------------------------------------------+
| OVEREXP    | int        | 0                              | over-illumination flag                             |
+------------+------------+--------------------------------+----------------------------------------------------+
| NOVEREXP   | int        | 10                             | Number of pixels overexposed /100                  |
+------------+------------+--------------------------------+----------------------------------------------------+
| EXCAMT     | float      | -87.9637451171875              | Camera temperature                                 |
+------------+------------+--------------------------------+----------------------------------------------------+
| PROXET     | float      | 23.36220932006836              | Thermal strap I/F, EXCam ProxE heater              |
+------------+------------+--------------------------------+----------------------------------------------------+
| FCMLOOP    | int        | 0                              | Control state FCM loop                             |
+------------+------------+--------------------------------+----------------------------------------------------+
| FSMINNER   | int        | 1                              | Control state FSM inner loop                       |
+------------+------------+--------------------------------+----------------------------------------------------+
| FSMLOS     | int        | 1                              | Control state FSM LOS loop                         |
+------------+------------+--------------------------------+----------------------------------------------------+
| FSMSG1     | float      | 0.003123962320387363           | Fast Steering Mirror SG1 (V)                       |
+------------+------------+--------------------------------+----------------------------------------------------+
| FSMSG2     | float      | -0.0085352323949337            | Fast Steering Mirror SG2 (V)                       |
+------------+------------+--------------------------------+----------------------------------------------------+
| FSMSG3     | float      | 0.005453826859593391           | Fast Steering Mirror SG3 (V)                       |
+------------+------------+--------------------------------+----------------------------------------------------+
| DMZLOOP    | int        | 0                              | Control state DM zernike loop                      |
+------------+------------+--------------------------------+----------------------------------------------------+
| SPAM_H     | float      | 1001.5126953125                | SPAM micron +H                                     |
+------------+------------+--------------------------------+----------------------------------------------------+
| SPAM_V     | float      | 16626.994140625                | SPAM micron +V                                     |
+------------+------------+--------------------------------+----------------------------------------------------+
| FPAM_H     | float      | 6775.67822265625               | FPAM micron +H                                     |
+------------+------------+--------------------------------+----------------------------------------------------+
| FPAM_V     | float      | 27653.51171875                 | FPAM micron +V                                     |
+------------+------------+--------------------------------+----------------------------------------------------+
| LSAM_H     | float      | 36898.02734375                 | LSAM micron +H                                     |
+------------+------------+--------------------------------+----------------------------------------------------+
| LSAM_V     | float      | 4636.49755859375               | LSAM micron +V                                     |
+------------+------------+--------------------------------+----------------------------------------------------+
| FSAM_H     | float      | 29387.306640625                | FSAM micron +H                                     |
+------------+------------+--------------------------------+----------------------------------------------------+
| FSAM_V     | float      | 12237.638671875                | FSAM micron +V                                     |
+------------+------------+--------------------------------+----------------------------------------------------+
| CFAM_H     | float      | 55829.65625                    | CFAM micron +H                                     |
+------------+------------+--------------------------------+----------------------------------------------------+
| CFAM_V     | float      | 10004.6142578125               | CFAM micron +V                                     |
+------------+------------+--------------------------------+----------------------------------------------------+
| DPAM_H     | float      | 38916.07421875                 | DPAM micron +H                                     |
+------------+------------+--------------------------------+----------------------------------------------------+
| DPAM_V     | float      | 26016.451171875                | DPAM micron +V                                     |
+------------+------------+--------------------------------+----------------------------------------------------+
| DATETIME   | str        | 2024-04-03T10:54:01.932        | Time of preceding 1Hz HK packet                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| DATA_LEVEL | str        | L1                             |                                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| MISSING    | bool       | False                          | Flagged if header keywords are missing             |
+------------+------------+--------------------------------+----------------------------------------------------+
| EMGAIN_C   | float      | 1000.0                         |                                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| EMGAIN_A   | int        | -1                             |                                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| DATALVL    | str        | L2a                            |                                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| KGAINPAR   | float      | 8.7                            |                                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| KGAIN      | float      | 8.7                            |                                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| ISPC       | bool       | False                          |                                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| BUNIT      | str        | DN                             |                                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| DESMEAR    | bool       | False                          | Was desmear applied to this frame?                 |
+------------+------------+--------------------------------+----------------------------------------------------+
| CTI_CORR   | bool       | False                          | Was CTI correction applied to this frame?          |
+------------+------------+--------------------------------+----------------------------------------------------+
| IS_BAD     | bool       | False                          | Was this frame deemed bad?                         |
+------------+------------+--------------------------------+----------------------------------------------------+
| RECIPE     | str        | {"name": "l1_to_l2a_basic",... |                                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| DRPVERSN   | str        | 2.2                            |                                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| DRPCTIME   | str        | 2025-06-12T09:23:48.330        |                                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| FWC_PP_E   | float      | 90000.0                        |                                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| FWC_EM_E   | float      | 100000.0                       |                                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| SAT_DN     | float      | 8045.977011494252              |                                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| HISTORY    | str        | Frames cropped and bias sub... |                                                    |
+------------+------------+--------------------------------+----------------------------------------------------+


ERR Header (HDU 2)
^^^^^^^^^^^^^^^^^^


+------------+------------+--------------------------------+----------------------------------------------------+
| Keyword    | Datatype   | Example Value                  | Description                                        |
+============+============+================================+====================================================+
| XTENSION   | str        | IMAGE                          | Image extension                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| BITPIX     | int        | -64                            | array data type                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| NAXIS      | int        | 3                              | number of array dimensions                         |
+------------+------------+--------------------------------+----------------------------------------------------+
| NAXIS1     | int        | 1024                           |                                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| NAXIS2     | int        | 1024                           |                                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| NAXIS3     | int        | 1                              |                                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| PCOUNT     | int        | 0                              | number of parameters                               |
+------------+------------+--------------------------------+----------------------------------------------------+
| GCOUNT     | int        | 1                              | number of groups                                   |
+------------+------------+--------------------------------+----------------------------------------------------+
| EXTNAME    | str        | ERR                            |                                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| TRK_ERRS   | bool       | False                          |                                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| LAYER_1    | str        | combined_error                 |                                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| HISTORY    | str        | Added error term: prescan_b... |                                                    |
+------------+------------+--------------------------------+----------------------------------------------------+


DQ Header (HDU 3)
^^^^^^^^^^^^^^^^^


+------------+------------+--------------------------------+----------------------------------------------------+
| Keyword    | Datatype   | Example Value                  | Description                                        |
+============+============+================================+====================================================+
| XTENSION   | str        | IMAGE                          | Image extension                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| BITPIX     | int        | 64                             | array data type                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| NAXIS      | int        | 2                              | number of array dimensions                         |
+------------+------------+--------------------------------+----------------------------------------------------+
| NAXIS1     | int        | 1024                           |                                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| NAXIS2     | int        | 1024                           |                                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| PCOUNT     | int        | 0                              | number of parameters                               |
+------------+------------+--------------------------------+----------------------------------------------------+
| GCOUNT     | int        | 1                              | number of groups                                   |
+------------+------------+--------------------------------+----------------------------------------------------+
| EXTNAME    | str        | DQ                             |                                                    |
+------------+------------+--------------------------------+----------------------------------------------------+


BIAS Header (HDU 4)
^^^^^^^^^^^^^^^^^^^


+------------+------------+--------------------------------+----------------------------------------------------+
| Keyword    | Datatype   | Example Value                  | Description                                        |
+============+============+================================+====================================================+
| XTENSION   | str        | IMAGE                          | Image extension                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| BITPIX     | int        | -32                            | array data type                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| NAXIS      | int        | 1                              | number of array dimensions                         |
+------------+------------+--------------------------------+----------------------------------------------------+
| NAXIS1     | int        | 1024                           |                                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| PCOUNT     | int        | 0                              | number of parameters                               |
+------------+------------+--------------------------------+----------------------------------------------------+
| GCOUNT     | int        | 1                              | number of groups                                   |
+------------+------------+--------------------------------+----------------------------------------------------+
| EXTNAME    | str        | BIAS                           | extension name                                     |
+------------+------------+--------------------------------+----------------------------------------------------+


