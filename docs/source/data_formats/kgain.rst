.. _kgain-label:

KGain Data Product
========================================


FITS HDU Structure
------------------


+-------+------------------+----------+----------------------+
| Index | Name             | Datatype | Array Size           |
+=======+==================+==========+======================+
| 0     | Primary          | None     | 0                    |
+-------+------------------+----------+----------------------+
| 1     | Image            | float64  | (1,)                 |
+-------+------------------+----------+----------------------+
| 2     | ERR              | float64  | (1,)                 |
+-------+------------------+----------+----------------------+
| 3     | PTC              | float64  | (400, 2)             |
+-------+------------------+----------+----------------------+


Header
------

Primary Header (HDU 0)
^^^^^^^^^^^^^^^^^^^^^^


+------------+------------+--------------------------------+----------------------------------------------------+
| Keyword    | Datatype   | Example Value                  | Description                                        |
+============+============+================================+====================================================+
| SIMPLE     | bool       | True                           | conforms to FITS standard                          |
+------------+------------+--------------------------------+----------------------------------------------------+
| BITPIX     | int        | 8                              | array data type                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| NAXIS      | int        | 0                              | number of array dimensions                         |
+------------+------------+--------------------------------+----------------------------------------------------+
| EXTEND     | bool       | True                           |                                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| OBSID      | int        | 0                              | Observation ID                                     |
+------------+------------+--------------------------------+----------------------------------------------------+
| BUILD      | int        | 22                             | CDMS pipeline build                                |
+------------+------------+--------------------------------+----------------------------------------------------+
| OBSTYPE    | str        | SCI                            | Observation Template                               |
+------------+------------+--------------------------------+----------------------------------------------------+
| VISTYPE    | str        | PUPILIMG                       |                                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| OBSNUM     | int        | 0                              |                                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| OBSNAME    | str        | MNFRAME                        |                                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| ORIGIN     | str        | DRP                            |                                                    |
+------------+------------+--------------------------------+----------------------------------------------------+


Image Header (HDU 1)
^^^^^^^^^^^^^^^^^^^^


+------------+------------+--------------------------------+----------------------------------------------------+
| Keyword    | Datatype   | Example Value                  | Description                                        |
+============+============+================================+====================================================+
| XTENSION   | str        | IMAGE                          | Image extension                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| BITPIX     | int        | -64                            | array data type                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| NAXIS      | int        | 1                              | number of array dimensions                         |
+------------+------------+--------------------------------+----------------------------------------------------+
| NAXIS1     | int        | 1                              |                                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| PCOUNT     | int        | 0                              | number of parameters                               |
+------------+------------+--------------------------------+----------------------------------------------------+
| GCOUNT     | int        | 1                              | number of groups                                   |
+------------+------------+--------------------------------+----------------------------------------------------+
| ARRTYPE    | str        | SCI                            |                                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| SCTSRT     | str        | 2024-03-08T05:12:11.704        | Start TAI                                          |
+------------+------------+--------------------------------+----------------------------------------------------+
| SCTEND     | str        | 2024-03-08T05:12:14.679        | Start TAI                                          |
+------------+------------+--------------------------------+----------------------------------------------------+
| STATUS     | int        | 0                              |                                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| HVCBIAS    | int        | 0                              | HV Clock bias                                      |
+------------+------------+--------------------------------+----------------------------------------------------+
| OPMODE     | str        | RESERVED                       | EXCAM readout operational mode                     |
+------------+------------+--------------------------------+----------------------------------------------------+
| EXPTIME    | float      | 5.0                            | Exposing stage duration (seconds)                  |
+------------+------------+--------------------------------+----------------------------------------------------+
| CMDGAIN    | float      | 1.0                            | Commanded gain                                     |
+------------+------------+--------------------------------+----------------------------------------------------+
| CYCLES     | int        | 11024051520588                 | EXCAM clock cycles since boot                      |
+------------+------------+--------------------------------+----------------------------------------------------+
| LASTEXP    | int        | 200000000                      | clock cycles spent in last exposure stage of re    |
+------------+------------+--------------------------------+----------------------------------------------------+
| BLNKTIME   | float      | 0.001560125                    | commanded blanking (seconds)                       |
+------------+------------+--------------------------------+----------------------------------------------------+
| BLNKCYC    | int        | 62405                          | commanded blanking (cycles)                        |
+------------+------------+--------------------------------+----------------------------------------------------+
| EXPCYC     | int        | 200000000                      | Exposing stage duration (cycles)                   |
+------------+------------+--------------------------------+----------------------------------------------------+
| OVEREXP    | int        | 0                              | over-illumination flag                             |
+------------+------------+--------------------------------+----------------------------------------------------+
| NOVEREXP   | int        | 0                              | Number of pixels overexposed /100                  |
+------------+------------+--------------------------------+----------------------------------------------------+
| EXCAMT     | float      | -88.05350494384766             | Camera temperature                                 |
+------------+------------+--------------------------------+----------------------------------------------------+
| PROXET     | float      | 24.38253974914551              | Thermal strap I/F, EXCam ProxE heater              |
+------------+------------+--------------------------------+----------------------------------------------------+
| FCMLOOP    | int        | 0                              | Control state FCM loop                             |
+------------+------------+--------------------------------+----------------------------------------------------+
| FSMINNER   | int        | 1                              | Control state FSM inner loop                       |
+------------+------------+--------------------------------+----------------------------------------------------+
| FSMLOS     | int        | 0                              | Control state FSM LOS loop                         |
+------------+------------+--------------------------------+----------------------------------------------------+
| FSMSG1     | float      | 8.08715776656754e-06           | Fast Steering Mirror SG1 (V)                       |
+------------+------------+--------------------------------+----------------------------------------------------+
| FSMSG2     | float      | 8.04138198873261e-06           | Fast Steering Mirror SG2 (V)                       |
+------------+------------+--------------------------------+----------------------------------------------------+
| FSMSG3     | float      | 1.26800532598281e-05           | Fast Steering Mirror SG3 (V)                       |
+------------+------------+--------------------------------+----------------------------------------------------+
| DMZLOOP    | int        | 0                              | Control state DM zernike loop                      |
+------------+------------+--------------------------------+----------------------------------------------------+
| SPAM_H     | float      | 1001.338317871094              | SPAM micron +H                                     |
+------------+------------+--------------------------------+----------------------------------------------------+
| SPAM_V     | float      | 16646.462890625                | SPAM micron +V                                     |
+------------+------------+--------------------------------+----------------------------------------------------+
| FPAM_H     | float      | 3523.235107421875              | FPAM micron +H                                     |
+------------+------------+--------------------------------+----------------------------------------------------+
| FPAM_V     | float      | 32841.41796875                 | FPAM micron +V                                     |
+------------+------------+--------------------------------+----------------------------------------------------+
| LSAM_H     | float      | 20821.3984375                  | LSAM micron +H                                     |
+------------+------------+--------------------------------+----------------------------------------------------+
| LSAM_V     | float      | 17394.0234375                  | LSAM micron +V                                     |
+------------+------------+--------------------------------+----------------------------------------------------+
| FSAM_H     | float      | 30783.40625                    | FSAM micron +H                                     |
+------------+------------+--------------------------------+----------------------------------------------------+
| FSAM_V     | float      | 2888.865478515625              | FSAM micron +V                                     |
+------------+------------+--------------------------------+----------------------------------------------------+
| CFAM_H     | float      | 62079.69140625                 | CFAM micron +H                                     |
+------------+------------+--------------------------------+----------------------------------------------------+
| CFAM_V     | float      | 33003.26171875                 | CFAM micron +V                                     |
+------------+------------+--------------------------------+----------------------------------------------------+
| DPAM_H     | float      | 62627.33203125                 | DPAM micron +H                                     |
+------------+------------+--------------------------------+----------------------------------------------------+
| DPAM_V     | float      | 21024.396484375                | DPAM micron +V                                     |
+------------+------------+--------------------------------+----------------------------------------------------+
| DATETIME   | str        | 2024-03-08T05:12:10.904        | Time of preceding 1Hz HK packet                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| DATA_LEVEL | str        | L1                             |                                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| MISSING    | bool       | False                          | Flagged if header keywords are missing             |
+------------+------------+--------------------------------+----------------------------------------------------+
| EMGAIN_C   | float      | 1.0                            |                                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| EMGAIN_A   | int        | -1                             |                                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| DATALVL    | str        | CAL                            |                                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| DESMEAR    | bool       | False                          | Was desmear applied to this frame?                 |
+------------+------------+--------------------------------+----------------------------------------------------+
| CTI_CORR   | bool       | False                          | Was CTI correction applied to this frame?          |
+------------+------------+--------------------------------+----------------------------------------------------+
| IS_BAD     | bool       | False                          | Was this frame deemed bad?                         |
+------------+------------+--------------------------------+----------------------------------------------------+
| RECIPE     | str        | {"name": "l1_to_kgain", "te... |                                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| DRPVERSN   | str        | 2.2                            | corgidrp version that produced this file           |
+------------+------------+--------------------------------+----------------------------------------------------+
| DRPCTIME   | str        | 2025-06-12T09:48:46.833        | When this file was saved                           |
+------------+------------+--------------------------------+----------------------------------------------------+
| FWC_PP_E   | float      | 90000.0                        |                                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| FWC_EM_E   | float      | 100000.0                       |                                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| SAT_DN     | float      | 7241.379310344827              |                                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| RN         | float      | 123.45239023569712             |                                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| RN_ERR     | float      | 17.934879172965676             |                                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| RN_UNIT    | str        | detected electrons             |                                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| FILE0      | str        | CGI_EXCAM_L1_0000051861.fits   | File name for the n-th science file used           |
+------------+------------+--------------------------------+----------------------------------------------------+
| DRPNFILE   | int        | 140                            | # of files used to create this processed frame     |
+------------+------------+--------------------------------+----------------------------------------------------+
| DATATYPE   | str        | KGain                          |                                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| BUNIT      | str        | Detected Electrons/DN          |                                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| HISTORY    | str        | Dataset to calibrate K-GAIN... |                                                    |
+------------+------------+--------------------------------+----------------------------------------------------+


ERR Header (HDU 2)
^^^^^^^^^^^^^^^^^^


+------------+------------+--------------------------------+----------------------------------------------------+
| Keyword    | Datatype   | Example Value                  | Description                                        |
+============+============+================================+====================================================+
| XTENSION   | str        | IMAGE                          | Image extension                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| BITPIX     | int        | -64                            | array data type                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| NAXIS      | int        | 1                              | number of array dimensions                         |
+------------+------------+--------------------------------+----------------------------------------------------+
| NAXIS1     | int        | 1                              |                                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| PCOUNT     | int        | 0                              | number of parameters                               |
+------------+------------+--------------------------------+----------------------------------------------------+
| GCOUNT     | int        | 1                              | number of groups                                   |
+------------+------------+--------------------------------+----------------------------------------------------+
| EXTNAME    | str        | ERR                            |                                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| TRK_ERRS   | bool       | False                          |                                                    |
+------------+------------+--------------------------------+----------------------------------------------------+


PTC Header (HDU 3)
^^^^^^^^^^^^^^^^^^


+------------+------------+--------------------------------+----------------------------------------------------+
| Keyword    | Datatype   | Example Value                  | Description                                        |
+============+============+================================+====================================================+
| XTENSION   | str        | IMAGE                          | Image extension                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| BITPIX     | int        | -64                            | array data type                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| NAXIS      | int        | 2                              | number of array dimensions                         |
+------------+------------+--------------------------------+----------------------------------------------------+
| NAXIS1     | int        | 2                              |                                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| NAXIS2     | int        | 400                            |                                                    |
+------------+------------+--------------------------------+----------------------------------------------------+
| PCOUNT     | int        | 0                              | number of parameters                               |
+------------+------------+--------------------------------+----------------------------------------------------+
| GCOUNT     | int        | 1                              | number of groups                                   |
+------------+------------+--------------------------------+----------------------------------------------------+
| EXTNAME    | str        | PTC                            |                                                    |
+------------+------------+--------------------------------+----------------------------------------------------+


